<!DOCTYPE html>
<html>
<head>
	<title>舔狗日记</title>
	<meta name="keywords" content="舔狗日记,青山绿水,">
	<meta name="description" content="这是一个舔狗日记集合网站">
	<link rel="shortcut icon" href="favicon.ico">
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
	<link rel="stylesheet" href="./static/css/main.css" />
	<!--noscript 元素用来定义在脚本未被执行时的替代内容（文本）。-->
	<noscript><link rel="stylesheet" href="./static/css/noscript.css" /></noscript>
	<style type="text/css">

		@font-face {
			font-family: 'MFShangYa';
			src: url('./static/fonts/MFShangYa.ttf') format('truetype');
			font-weight: normal;
			font-style: normal;
		}

	</style>
</head>
<!-- onselectstart="return false" 实现元素内文本不被选中-->
<body onselectstart="return false" oncontextmenu=self.event.returnValue=false>

<!-- Wrapper -->
<div id="wrapper">
	<!-- Header -->
	<header id="header">
		<div class="logo">
			<span>舔狗日记</span></div>
		<div class="content">
			<div class="inner">
				<h2><span id="now_year"></span></h2>
				<h3 id="sentence" style="font-family:MFShangYa;"></h3>
			</div>
		</div>
		<button class="btn btn-primary btn-filled btn-xs" onclick="randomSentence()">再来一篇</button>
	</header>

	<!-- Footer -->
	<footer id="footer">
		<p class="copyright">©巧克力 版权所有<a target="_black" href=''>巧克力发布</a></p>
	</footer>
</div>

<!-- BG -->
<div id="bg"></div>

<!-- Scripts -->
<script src="./static/js/jquery.min.js"></script>
<script src="./static/js/index.js"></script>
<!-- 刷新页面特效 -->
<script src="./static/js/skel.min.js"></script>
<script src="./static/js/util.js"></script>
<script src="./static/js/main.js"></script>
<!-- 刷新页面特效 -->

<script>
	const date = new Date();
	//const minDate = myDate.toLocaleDateString();
	let year = date.getFullYear().toString();
	let month = (date.getMonth() + 1).toString();
	let day =  date.getDate().toString();
	const nowDate = year+"年"+month+ "月"+day+"日";
	//$("#now_year").html(nowDate);

	let city = localStorage.getItem('city') || '';
	let cloud = localStorage.getItem('cloud') || '';
	let cond = localStorage.getItem('cond') || '';
	const dateStart = new Date(localStorage.getItem('date') || new Date());
	const dayDiff = date.getDate() - dateStart.getDate();
	if(city == '' || dayDiff >= 1) {
		$.post(
				'https://free-api.heweather.net/s6/weather/now?location=auto_ip&key=115e4ece0659467bb560b1f070675980',
				function(data){
					const weather = data.HeWeather6[0] || {};
					city = weather.basic.parent_city || '';
					cloud = weather.now.fl || ''
					cond = weather.now.cond_txt || ''
					localStorage.setItem('city',city);
					localStorage.setItem('cloud',cloud);
					localStorage.setItem('cond',cond);
					localStorage.setItem('date',new Date());
					renderWeather();
				},'json'
		) // 天气结束
	} else {
		renderWeather();
	}
	function renderWeather(){
		const weatherHTML = '<time>' + nowDate + '</time>&nbsp;<span>' + city + '·' + cond + '·' + cloud + '&#8451;</span>';
		$('#now_year').html(weatherHTML);
	}
</script>

</body>
</html>
